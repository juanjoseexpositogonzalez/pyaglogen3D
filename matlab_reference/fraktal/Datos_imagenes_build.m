function fig_hdl = Datos_imagenes_build% DATOS_IMAGENES_BUILD%-------------------------------------------------------------------------------% File name   : Datos_imagenes_build.m%-------------------------------------------------------------------------------% Initialize handles structurehandles = struct();% Create all UI controlsbuild_gui();% Assign function outputfig_hdl = handles.figuraimagenes;%% ---------------------------------------------------------------------------% Variablesprimeravezi=1;handles.dir_img_ind=0;grupo=getappdata(0,'grupo');handles.imagen='0';handles.txt_datos=0;handles.dir_img_grupo=0;%% ---------------------------------------------------------------------------	function build_gui()% Creation of all uicontrols		% --- FIGURE -------------------------------------		handles.figuraimagenes = figure( ...			'Tag', 'figuraimagenes', ...			'Units', 'characters', ...			'Position', [25.4 0.923076923076923 230 40], ...			'Name', 'Datos_imagenes', ...			'MenuBar', 'none', ...			'NumberTitle', 'off',...			'Color', [0.4 0.6 1]);		% --- PANELS -------------------------------------        handles.subida_panel = uipanel( ...            'Parent', handles.figuraimagenes, ...            'Tag', 'subida_panel', ...            'Units', 'characters', ...            'Position', [5 10 48 8], ...            'Title', 'Modos de subida de imágenes', ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [0.4 0.3 1], ...            'HighlightColor', [1 0.35 0], ...            'TitlePosition', 'Centertop');                handles.subida_grupo = uipanel( ...            'Parent', handles.figuraimagenes, ...            'Tag', 'subida_panel', ...            'Units', 'characters', ...            'Position', [62.2 10 48 11.5], ...            'Title', 'Opciones de subida en grupo', ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [0.4 0.3 1], ...            'HighlightColor', [1 0.35 0], ...            'visible', 'off', ...            'TitlePosition', 'Centertop');        		handles.subida_manual_panel = uipanel( ...			'Parent', handles.figuraimagenes, ...			'Tag', 'subida_manual_panel', ...			'Units', 'characters', ...			'Position', [62.2 10 158 20], ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [0.4 0.3 1], ...            'HighlightColor', [1 0.35 0], ...			'Title', 'Subida individual', ...            'visible', 'off', ...            'TitlePosition', 'Centertop');		handles.subida_archivo_panel = uipanel( ...			'Parent', handles.figuraimagenes, ...			'Tag', 'subida_archivo_panel', ...			'Units', 'characters', ...			'Position', [119.8 10 100.2 18.2153846153846], ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [0.4 0.3 1], ...            'HighlightColor', [1 0.35 0], ...			'Title', 'Subida de imágenes con archivo Excel', ...            'visible', 'off', ...            'TitlePosition', 'Centertop');                handles.subida_archivo_panel_nuevo = uipanel( ...			'Parent', handles.figuraimagenes, ...			'Tag', 'subida_manual_panel_nuevo', ...			'Units', 'characters', ...			'Position', [119.8 10 100.2 16.8153846153846], ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [0.4 0.3 1], ...            'HighlightColor', [1 0.35 0], ...			'Title', 'Subida de imágenes sin archivo Excel', ...            'visible', 'off', ...            'TitlePosition', 'Centertop');        		% --- AXES -------------------------------------        		handles.img_seleccionada_axes = axes( ...			'Parent', handles.subida_manual_panel, ...			'Tag', 'img_seleccionada_axes', ...			'Units', 'characters', ...			'Position', [103.5 1 44 16.9230769230769], ...            'visible', 'off');		% --- STATIC TEXTS -------------------------------------		handles.npix_texto = uicontrol( ...			'Parent', handles.subida_manual_panel, ...			'Tag', 'npix_texto', ...			'UserData', zeros(1,0), ...			'Style', 'text', ...			'Units', 'characters', ...			'Position', [9.6 8.692307692 25.4 1.30769230769231], ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...			'String', 'nº pixeles/100nm');		handles.dpo_mat_texto = uicontrol( ...			'Parent', handles.subida_manual_panel, ...			'Tag', 'dpo_mat_texto', ...			'UserData', zeros(1,0), ...			'Style', 'text', ...			'Units', 'characters', ...			'Position', [5.6 4 32.2 3.30769230769231], ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...			'String', {'Diámetro medio de las';'partículas [nm]'});		handles.titulo_imagenes_texto = uicontrol( ...			'Parent', handles.figuraimagenes, ...			'Tag', 'titulo_imagenes_texto', ...			'Style', 'text', ...			'Units', 'characters', ...			'Position', [99.6 33 30.2 2.15384615384615], ...			'String', 'IMÁGENES', ...            'FontSize', 15, ...            'FontName', 'Candara', ...            'Backgroundcolor', [0.4 0.6 1],...            'Foregroundcolor', [1 1 1]);		handles.dir_img_texto = uicontrol( ...			'Parent', handles.subida_archivo_panel, ...			'Tag', 'dir_img_texto', ...			'Style', 'text', ...			'Units', 'characters', ...			'Position', [2.2 9.8538461538462 30.6 2.90769230769231], ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...			'String', {'Carpeta con las','imágenes'});        %NUEVOS BOTONES                handles.dir_img_texto_nuevo = uicontrol( ...			'Parent', handles.subida_archivo_panel_nuevo, ...			'Tag', 'dir_img_texto_nuevo', ...			'Style', 'text', ...			'Units', 'characters', ...			'Position', [2.2 8.438461538462 30.6 2.90769230769231], ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...			'String', {'Carpeta con las','imágenes'});                handles.npix_texto_nuevo = uicontrol( ...			'Parent', handles.subida_archivo_panel_nuevo, ...			'Tag', 'npix_texto_nuevo', ...			'UserData', zeros(1,0), ...			'Style', 'text', ...			'Units', 'characters', ...			'Position', [9.6 5.692307692 25.4 1.30769230769231], ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...			'String', 'nº pixeles/100nm');		handles.dpo_mat_texto_nuevo = uicontrol( ...			'Parent', handles.subida_archivo_panel_nuevo, ...			'Tag', 'dpo_mat_texto_nuevo', ...			'UserData', zeros(1,0), ...			'Style', 'text', ...			'Units', 'characters', ...			'Position', [5.6 1 32.2 3.30769230769231], ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...			'String', {'Diámetro medio de las';'partículas [nm]'});		% --- PUSHBUTTONS -------------------------------------		handles.sub_img_boton = uicontrol( ...			'Parent', handles.subida_manual_panel, ...			'Tag', 'sub_img_boton', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [2.8 13 20.2 2.23076923076923], ...			'String', 'Subir imagen', ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...			'Callback', @sub_img_boton_Callback);		handles.guardar_datos_boton = uicontrol( ...			'Parent', handles.subida_manual_panel, ...			'Tag', 'guardar_datos_boton', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [69.2 6.5 24.2 2.23076923076923], ...			'String', 'Guardar datos', ...            'FontSize', 12, ...            'FontName', 'Candara', ...             'Callback', @guardar_datos_boton_Callback);		handles.dir_img_boton = uicontrol( ...			'Parent', handles.subida_archivo_panel, ...			'Tag', 'dir_img_boton', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [30.8 10.4615384615385 4.4 1.76923076923077], ...			'String', '...', ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...			'Callback', @dir_img_boton_Callback);		handles.archivo_datos_boton = uicontrol( ...			'Parent', handles.subida_archivo_panel, ...			'Tag', 'archivo_datos_boton', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [5 5.6153846153847 28.2 2.46153846153846], ...			'String', 'Subir archivo datos', ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...			'Callback', @archivo_datos_boton_Callback);                handles.tomar_datos_boton = uicontrol( ...			'Parent', handles.subida_archivo_panel, ...			'Tag', 'tomar_datos_boton', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [37 2 25.2 2.46153846153846], ...			'String', 'Tomar datos', ...            'FontSize', 12, ...            'FontName', 'Candara', ...			'Callback', @tomar_datos_boton_Callback);		handles.instrucciones_boton = uicontrol( ...			'Parent', handles.subida_archivo_panel, ...			'Tag', 'instrucciones_boton', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [39.6 13.6384615384615 20.2 2.07692307692308], ...			'String', 'Instrucciones', ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [0.4 0.3 1], ...            'Callback', @instrucciones_boton_Callback);                %NUEVOS BOTONES                handles.instrucciones_boton_grupo = uicontrol( ...			'Parent', handles.subida_grupo, ...			'Tag', 'instrucciones_boton_grupo', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [13.5 7 20.2 2.07692307692308], ...			'String', 'Instrucciones', ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [0.4 0.3 1], ...            'Callback', @instrucciones_boton_grupo_Callback);                handles.dir_img_boton_nuevo = uicontrol( ...			'Parent', handles.subida_archivo_panel_nuevo, ...			'Tag', 'dir_img_boton_nuevo', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [30.8 9.0615384615385 4.4 1.76923076923077], ...			'String', '...', ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...			'Callback', @dir_img_boton_nuevo_Callback);                handles.instrucciones_boton_nuevo = uicontrol( ...			'Parent', handles.subida_archivo_panel_nuevo, ...			'Tag', 'instrucciones_boton_nuevo', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [42.2 12.2384615384615 20.2 2.07692307692308], ...			'String', 'Instrucciones', ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [0.4 0.3 1], ...            'Callback', @instrucciones_boton_nuevo_Callback);                handles.tomar_datos_boton_nuevo = uicontrol( ...			'Parent', handles.subida_archivo_panel_nuevo, ...			'Tag', 'tomar_datos_boton_nuevo', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [69.2 3.5 24.2 2.23076923076923], ...			'String', 'Tomar datos', ...            'FontSize', 12, ...            'FontName', 'Candara', ...             'Callback', @tomar_datos_boton_nuevo_Callback);        %--------------------------------------------------..------------------		handles.atras_boton = uicontrol( ...			'Parent', handles.figuraimagenes, ...			'Tag', 'atras_boton', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [148.8 2.15384615384615 22.4 2.38461538461538], ...			'String', '< Atrás', ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [0.4 0.3 1], ...			'Callback', @atras_boton_Callback);		handles.siguiente_boton = uicontrol( ...			'Parent', handles.figuraimagenes, ...			'Tag', 'siguiente_boton', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [173.2 2.15384615384615 22.4 2.38461538461538], ...			'String', 'Siguiente >', ...            'enable', 'off', ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [0.4 0.3 1], ...			'Callback', @siguiente_boton_Callback);		handles.salir_boton = uicontrol( ...			'Parent', handles.figuraimagenes, ...			'Tag', 'salir_boton', ...			'Style', 'pushbutton', ...			'Units', 'characters', ...			'Position', [197.6 2.15384615384615 22.4 2.38461538461538], ...			'String', 'Salir', ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [0.4 0.3 1], ...			'Callback', @salir_boton_Callback);		% --- RADIO BUTTONS -------------------------------------		handles.sub_manual = uicontrol( ...			'Parent', handles.subida_panel, ...			'Tag', 'sub_archivo', ...			'Style', 'radiobutton', ...			'Units', 'characters', ...			'Position', [1 4 35.2 1.76923076923077], ...			'String', 'Subida individual', ...            'value', 0, ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...            'Callback', @sub_manual_Callback);		handles.sub_archivo = uicontrol( ...			'Parent', handles.subida_panel, ...			'Tag', 'sub_archivo', ...			'Style', 'radiobutton', ...			'Units', 'characters', ...			'Position', [1 1 35.2 1.76923076923077], ...			'String', 'Subida en grupo', ...            'value', 0, ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...            'Callback', @sub_archivo_Callback);                handles.sub_grupo_sin = uicontrol( ...			'Parent', handles.subida_grupo, ...			'Tag', 'sub_grupo_sin', ...			'Style', 'radiobutton', ...			'Units', 'characters', ...			'Position', [1 4 40 1.76923076923077], ...			'String', 'Subida sin archivo Excel', ...            'value', 0, ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...            'Callback', @sub_grupo_sin_Callback);		handles.sub_grupo_con = uicontrol( ...			'Parent', handles.subida_grupo, ...			'Tag', 'sub_grupo_con', ...			'Style', 'radiobutton', ...			'Units', 'characters', ...			'Position', [1 1 40 1.76923076923077], ...			'String', 'Subida con archivo Excel', ...            'value', 0, ...            'FontSize', 12, ...            'FontName', 'Candara', ...            'Foregroundcolor', [1 0.35 0],...            'Callback', @sub_grupo_con_Callback);                		% --- EDIT TEXTS -------------------------------------		        handles.imagen_textoblanco = uicontrol( ...			'Parent', handles.subida_manual_panel, ...			'Tag', 'imagen', ...			'UserData', zeros(1,0), ...			'Style', 'edit', ...			'Units', 'characters', ...			'Position', [24.8 13 68.3 2.23076923076923], ...			'BackgroundColor', [1 1 1], ...			'String', {''}, ...            'enable', 'off');		handles.npix_entrada = uicontrol( ...			'Parent', handles.subida_manual_panel, ...			'Tag', 'npix', ...			'Style', 'edit', ...			'Units', 'characters', ...			'Position', [40.8 8.5 23.2 1.69230769230769], ...			'BackgroundColor', [1 1 1], ...			'String', 'npix', ...            'FontSize', 12, ...            'FontName', 'Candara');		handles.dpomat_entrada = uicontrol( ...			'Parent', handles.subida_manual_panel, ...			'Tag', 'dpomat', ...			'Style', 'edit', ...			'Units', 'characters', ...			'Position', [40.8 4.923076923 23.2 1.69230769230769], ...			'BackgroundColor', [1 1 1], ...			'String', 'dpo', ...            'FontSize', 12, ...            'FontName', 'Candara');		handles.dir_img = uicontrol( ...			'Parent', handles.subida_archivo_panel, ...			'Tag', 'dir_img', ...			'UserData', zeros(1,0), ...			'Style', 'edit', ...			'Units', 'characters', ...			'Position', [36.2000000000001 10.1538461538462 60.2 2.23076923076923], ...			'BackgroundColor', [1 1 1], ...			'String', {''}, ...            'enable', 'off');		handles.archivo_datos = uicontrol( ...			'Parent', handles.subida_archivo_panel, ...			'Tag', 'archivo_datos', ...			'UserData', zeros(1,0), ...			'Style', 'edit', ...			'Units', 'characters', ...			'Position', [36.2 5.6923076923077 60.2 2.23076923076923], ...			'BackgroundColor', [1 1 1], ...			'String', {''}, ...            'enable', 'off');        %NUEVO BOTONES                handles.dir_img_nuevo = uicontrol( ...			'Parent', handles.subida_archivo_panel_nuevo, ...			'Tag', 'dir_img_nuevo', ...			'UserData', zeros(1,0), ...			'Style', 'edit', ...			'Units', 'characters', ...			'Position', [36.2000000000001 8.7538461538462 60.2 2.23076923076923], ...			'BackgroundColor', [1 1 1], ...			'String', {''}, ...            'enable', 'off');                handles.npix_entrada_nuevo = uicontrol( ...			'Parent', handles.subida_archivo_panel_nuevo, ...			'Tag', 'npix_entrada_nuevo', ...			'Style', 'edit', ...			'Units', 'characters', ...			'Position', [40.8 5.5 23.2 1.69230769230769], ...			'BackgroundColor', [1 1 1], ...			'String', 'npix', ...            'FontSize', 12, ...            'FontName', 'Candara');		handles.dpomat_entrada_nuevo = uicontrol( ...			'Parent', handles.subida_archivo_panel_nuevo, ...			'Tag', 'dpomat_entrada_nuevo', ...			'Style', 'edit', ...			'Units', 'characters', ...			'Position', [40.8 1.923076923 23.2 1.69230769230769], ...			'BackgroundColor', [1 1 1], ...			'String', 'dpo', ...            'FontSize', 12, ...            'FontName', 'Candara');                movegui(handles.figuraimagenes,'center')	end%% ---------------------------------------------------------------------------	function sub_img_boton_Callback(hObject,evendata) %#ok<INUSD>        if primeravezi==1            [handles.imagen,handles.dir_img_ind]=uigetfile({'*.jpg',...                'Archivo JPG';'*.png','Archivo PNG';'*.tif',...                'Archivo TIF';'*.gif','Archivo GIF';'*.bmp','Archivo BMP'},'Seleccione una imagen');        else            [handles.imagen,handles.dir_img_ind]=uigetfile({'*.jpg',...                'Archivo JPG';'*.png','Archivo PNG';'*.ti',...                'Archivo TIF';'*.gif','Archivo GIF';'*.bmp','Archivo BMP'},'Seleccione una imagen',...                handles.dir_img_ind);        end               if ~isequal(handles.imagen,0)           set(handles.imagen_textoblanco,'string',strcat(handles.dir_img_ind,handles.imagen));           set(handles.img_seleccionada_axes,'visible','on');           axes(handles.img_seleccionada_axes)           background = imread(strcat(handles.dir_img_ind,handles.imagen));           axis off;           imshow(background);           primeravezi=0;       end        	end%% ---------------------------------------------------------------------------	function dir_img_boton_Callback(hObject,evendata) %#ok<INUSD>        handles.dir_img_grupo=uigetdir('','Seleccione la carpeta donde están guardadas las imágenes');        if ~isequal(handles.dir_img_grupo,0)            set(handles.dir_img,'string',handles.dir_img_grupo);        end        setappdata(0,'dir_img_grupo',handles.dir_img_grupo);	end%% ---------------------------------------------------------------------------	function archivo_datos_boton_Callback(hObject,evendata) %#ok<INUSD>        [handles.txt_datos,handles.dir_datos]=uigetfile(strcat(handles.dir_img_grupo,'\*xls;*.xlsx'),'Seleccione el archivo con los datos');        if ~isequal(handles.txt_datos,0)            set(handles.archivo_datos,'string',strcat(handles.dir_datos,handles.txt_datos));%             handles.data=xlsread(strcat(handles.dir_datos,handles.txt_datos)); %CAMBIO            [~,~,handles.data]=xlsread(strcat(handles.dir_datos,handles.txt_datos));        end    end%% ---------------------------------------------------------------------------    function tomar_datos_boton_Callback(hObject,evendata) %#ok<INUSD>                if isequal(handles.txt_datos,0) || isequal(handles.dir_img_grupo,0)             error=errordlg('No se ha elegido un directorio o un archivo','Error');                            kids0=findobj(error,'Type','UIControl');                kids1=findobj(error,'Type','Text');                % change the font and fontsize                extent0=get(kids1,'Extent'); % text extent in old font                set([kids0,kids1],'FontName','Candara','FontSize',12);                set(kids0,'Foregroundcolor',[0.4 0.3 1]);                extent1=get(kids1,'Extent'); % text extent in new font                % need to resize the msgbox object to accommodate new FontName                % and FontSize                delta=extent1-extent0; % change in extent                            pos=get(kids0,'Position'); % msgbox current position                pos=pos+delta; % change size of msgbox                set(kids0,'Position',pos); % set new position                            pos=get(error,'Position'); % msgbox current position                pos=pos+delta; % change size of msgbox                set(error,'Position',pos); % set new position                        else             set(handles.tomar_datos_boton,'str','CARGANDO...','backg',[1 .6 .6]) % Change color of button.                     pause(.01)  % FLUSH the event queue, drawnow would work too.        %             for j=1:size(handles.data,1) %CAMBIO%                 handles.nfoto_con_dir(j,1)={strcat(handles.dir_img_grupo,'\',num2str(handles.data(j,1)))};%                 handles.nfoto_sin_dir{j,1}=num2str(handles.data(j,1));%             end            for j=2:size(handles.data,1)                if isa(handles.data{j,1},'double')==1                    handles.nfoto_con_dir(j-1,1)=strcat(handles.dir_img_grupo,'\',{num2str(handles.data{j,1})});                    handles.nfoto_sin_dir(j-1,1)={num2str(handles.data{j,1})};                else                    handles.nfoto_con_dir(j-1,1)=strcat(handles.dir_img_grupo,'\',handles.data(j,1));                    handles.nfoto_sin_dir(j-1,1)=handles.data(j,1);                end            end            setappdata(0,'nfoto',handles.nfoto_con_dir);            setappdata(0,'foto',handles.nfoto_sin_dir');%             handles.npixescala=handles.data(:,2); setappdata(0,'npixescala',handles.npixescala');%CAMBIO%             handles.dpomat=handles.data(:,3); setappdata(0,'dpomat',handles.dpomat');%CAMBIO            handles.npixescala=handles.data(2:size(handles.data,1),2); setappdata(0,'npixescala',handles.npixescala');            handles.dpomat=handles.data(2:size(handles.data,1),3); setappdata(0,'dpomat',handles.dpomat');                    grupo=1; setappdata(0,'grupo',grupo);                    pause(.01)  % FLUSH the event queue, drawnow would work too.                    set(handles.tomar_datos_boton,'String','CARGADO','backg',[0 .9 0])  % Now reset the button features.                    if strcmp(get(handles.tomar_datos_boton,'String'),'CARGADO')==1                set (handles.siguiente_boton,'enable','on');            end        end            end%-----------------------------------------------------------------------------function dir_img_boton_nuevo_Callback(hObject,evendata) %#ok<INUSD>        handles.dir_img_grupo=uigetdir('','Seleccione la carpeta donde están guardadas las imágenes');        if ~isequal(handles.dir_img_grupo,0)            set(handles.dir_img_nuevo,'string',handles.dir_img_grupo);        end        setappdata(0,'dir_img_grupo',handles.dir_img_grupo);	end%% ---------------------------------------------------------------------------    function tomar_datos_boton_nuevo_Callback(hObject,evendata) %#ok<INUSD>                handles.npix_nuevo=str2double(get(handles.npix_entrada_nuevo,'string'));        handles.dpo_mat_nuevo=str2double(get(handles.dpomat_entrada_nuevo,'string'));                if handles.npix_nuevo<0 || handles.dpo_mat_nuevo<0 || isequal(handles.dir_img_grupo,0)            error=errordlg('Algún dato no es un número positivo o no se ha cargado un directorio','Error');                         kids0=findobj(error,'Type','UIControl');                kids1=findobj(error,'Type','Text');                                % change the font and fontsize                extent0=get(kids1,'Extent'); % text extent in old font                set([kids0,kids1],'FontName','Candara','FontSize',12);                set(kids0,'Foregroundcolor',[0.4 0.3 1]);                extent1=get(kids1,'Extent'); % text extent in new font                % need to resize the msgbox object to accommodate new FontName                % and FontSize                delta=extent1-extent0; % change in extent                            pos=get(kids0,'Position'); % msgbox current position                pos=pos+delta; % change size of msgbox                set(kids0,'Position',pos); % set new position                            pos=get(error,'Position'); % msgbox current position                pos=pos+delta; % change size of msgbox                set(error,'Position',pos); % set new position                        elseif handles.npix_nuevo>0 && handles.dpo_mat_nuevo>0            set(handles.tomar_datos_boton_nuevo,'str','CARGANDO...','backg',[1 .6 .6]) % Change color of button.                     pause(.01)  % FLUSH the event queue, drawnow would work too.                              archivos=dir(handles.dir_img_grupo);           setappdata(0,'archivos',archivos);          % Quitamos los directorios           archivos([archivos.isdir])=[];          % Filtro de extension (sólo queremos los archivos cuya extensión coincida con la deseada)           filtro='.jpg';           % Quitamos los directorios . y .. (en caso en que su atributo isdir no los haya eliminado)           mask=ismember({archivos.name},{ '.', '..' });           archivos(mask)=[];           %El siguiente bucle procesa los archivos:           for archivo=1:length(archivos)           [~,~,ext]=fileparts(archivos(archivo).name);             if (strcmp(ext,filtro))                               end           end           handles.data=[];           handles.data(:,2)=handles.npix_nuevo;           handles.data(:,3)=handles.dpo_mat_nuevo;           setappdata(0,'data',handles.data);            for j=2:size(handles.data,1)                if isa(handles.data{j,1},'double')==1                    handles.nfoto_con_dir(j-1,1)=strcat(handles.dir_img_grupo,'\',{num2str(handles.data{j,1})});                    handles.nfoto_sin_dir(j-1,1)={num2str(handles.data{j,1})};                else                    handles.nfoto_con_dir(j-1,1)=strcat(handles.dir_img_grupo,'\',handles.data(j,1));                    handles.nfoto_sin_dir(j-1,1)=handles.data(j,1);                end            end            setappdata(0,'nfoto',handles.nfoto_con_dir);            setappdata(0,'foto',handles.nfoto_sin_dir');                        handles.npixescala=handles.data(2:size(handles.data,1),2); setappdata(0,'npixescala',handles.npixescala');            handles.dpomat=handles.data(2:size(handles.data,1),3); setappdata(0,'dpomat',handles.dpomat');                    grupo=1; setappdata(0,'grupo',grupo);                    pause(.01)  % FLUSH the event queue, drawnow would work too.                    set(handles.tomar_datos_boton,'String','CARGADO','backg',[0 .9 0])  % Now reset the button features.                    if strcmp(get(handles.tomar_datos_boton_nuevo,'String'),'CARGADO')==1                set (handles.siguiente_boton,'enable','on');            end                        else             error=errordlg('Algún dato introducido no es un número positivo','Error');                            kids0=findobj(error,'Type','UIControl');                kids1=findobj(error,'Type','Text');                % change the font and fontsize                extent0=get(kids1,'Extent'); % text extent in old font                set([kids0,kids1],'FontName','Candara','FontSize',12);                set(kids0,'Foregroundcolor',[0.4 0.3 1]);                extent1=get(kids1,'Extent'); % text extent in new font                % need to resize the msgbox object to accommodate new FontName                % and FontSize                delta=extent1-extent0; % change in extent                            pos=get(kids0,'Position'); % msgbox current position                pos=pos+delta; % change size of msgbox                set(kids0,'Position',pos); % set new position                            pos=get(error,'Position'); % msgbox current position                pos=pos+delta; % change size of msgbox                set(error,'Position',pos); % set new position        end            end%% ---------------------------------------------------------------------------	function atras_boton_Callback(hObject,evendata) %#ok<INUSD>        close;        Datos_entrada_build;	end%% ---------------------------------------------------------------------------	function siguiente_boton_Callback(hObject,evendata) %#ok<INUSD>        close;        version_programa_build;	end%% ---------------------------------------------------------------------------	function salir_boton_Callback(hObject,evendata) %#ok<INUSD>        close all;	end%% ---------------------------------------------------------------------------	function guardar_datos_boton_Callback(hObject,evendata) %#ok<INUSD>        handles.npix=str2double(get(handles.npix_entrada,'string'));        handles.dpo_mat=str2double(get(handles.dpomat_entrada,'string'));                [handles.carpeta_img_ind,handles.nombre_img_ind,handles.extension_img_ind]=fileparts(strcat(handles.dir_img_ind,handles.imagen));                if handles.npix<0 || handles.dpo_mat<0 || strcmp(handles.imagen,'0')==1            error=errordlg('Algún dato no es un número positivo o no has cargado una imagen','Error');                            kids0=findobj(error,'Type','UIControl');                kids1=findobj(error,'Type','Text');                % change the font and fontsize                extent0=get(kids1,'Extent'); % text extent in old font                set([kids0,kids1],'FontName','Candara','FontSize',12);                set(kids0,'Foregroundcolor',[0.4 0.3 1]);                extent1=get(kids1,'Extent'); % text extent in new font                % need to resize the msgbox object to accommodate new FontName                % and FontSize                delta=extent1-extent0; % change in extent                            pos=get(kids0,'Position'); % msgbox current position                pos=pos+delta; % change size of msgbox                set(kids0,'Position',pos); % set new position                            pos=get(error,'Position'); % msgbox current position                pos=pos+delta; % change size of msgbox                set(error,'Position',pos); % set new position                        elseif handles.npix>0 && handles.dpo_mat>0            handles.nfoto_con_dir={strcat(handles.dir_img_ind,handles.imagen)}; setappdata(0,'nfoto',handles.nfoto_con_dir');            handles.nfoto_sin_dir={handles.nombre_img_ind}; setappdata(0,'foto',handles.nfoto_sin_dir');            handles.npixescala=handles.npix; setappdata(0,'npixescala',handles.npixescala);            handles.dpomat=handles.dpo_mat; setappdata(0,'dpomat',handles.dpomat);                        set(handles.guardar_datos_boton,'String','LISTO','backg',[0 .9 0])  % Now reset the button features.          else             error=errordlg('Algún dato introducido no es un número positivo','Error');                            kids0=findobj(error,'Type','UIControl');                kids1=findobj(error,'Type','Text');                % change the font and fontsize                extent0=get(kids1,'Extent'); % text extent in old font                set([kids0,kids1],'FontName','Candara','FontSize',12);                set(kids0,'Foregroundcolor',[0.4 0.3 1]);                extent1=get(kids1,'Extent'); % text extent in new font                % need to resize the msgbox object to accommodate new FontName                % and FontSize                delta=extent1-extent0; % change in extent                            pos=get(kids0,'Position'); % msgbox current position                pos=pos+delta; % change size of msgbox                set(kids0,'Position',pos); % set new position                            pos=get(error,'Position'); % msgbox current position                pos=pos+delta; % change size of msgbox                set(error,'Position',pos); % set new position        end                grupo=-1; setappdata(0,'grupo',grupo);                if strcmp(get(handles.guardar_datos_boton,'String'),'LISTO')==1            set (handles.siguiente_boton,'enable','on');        end    end%% ---------------------------------------------------------------------------	function instrucciones_boton_grupo_Callback(hObject,evendata) %#ok<INUSD>        instrucciones_grupo_build	end%% ---------------------------------------------------------------------------	function instrucciones_boton_Callback(hObject,evendata) %#ok<INUSD>        instrucciones_build    end%% ---------------------------------------------------------------------------	function instrucciones_boton_nuevo_Callback(hObject,evendata) %#ok<INUSD>        instrucciones_nuevo_build	end%% ---------------------------------------------------------------------------   function sub_manual_Callback(hObject,evendata) %#ok<INUSD>        if get(handles.sub_archivo,'value')==1            set(handles.sub_archivo,'value',0);            set(handles.subida_manual_panel,'visible','on');            set(handles.subida_grupo,'visible','off');            set(handles.subida_archivo_panel,'visible','off');            set(handles.sub_grupo_con,'value',0);            set(handles.subida_archivo_panel,'visible','off');            set(handles.sub_grupo_sin,'value',0);            set(handles.subida_archivo_panel_nuevo,'visible','off');                    elseif get(handles.sub_manual,'value')==0            set(handles.subida_manual_panel,'visible','off');            set(handles.subida_grupo,'visible','off');            set(handles.subida_archivo_panel,'visible','off');            set(handles.subida_archivo_panel,'visible','off');            set(handles.subida_archivo_panel_nuevo,'visible','off');        else               set(handles.subida_manual_panel,'visible','on');            set(handles.subida_grupo,'visible','off');            set(handles.sub_grupo_con,'value',0);            set(handles.subida_archivo_panel,'visible','off');            set(handles.sub_grupo_sin,'value',0);            set(handles.subida_archivo_panel_nuevo,'visible','off');        end   end%% ---------------------------------------------------------------------------    function sub_archivo_Callback(hObject,evendata) %#ok<INUSD>        if get(handles.sub_manual,'value')==1            set(handles.sub_manual,'value',0);            set(handles.subida_manual_panel,'visible','off');            set(handles.subida_grupo,'visible','on');            set(handles.subida_archivo_panel,'visible','off');            set(handles.sub_grupo_con,'value',0);            set(handles.subida_archivo_panel,'visible','off');            set(handles.sub_grupo_sin,'value',0);            set(handles.subida_archivo_panel_nuevo,'visible','off');        elseif get(handles.sub_archivo,'value')==0            set(handles.subida_manual_panel,'visible','off');            set(handles.subida_grupo,'visible','off');            set(handles.subida_archivo_panel,'visible','off');            set(handles.subida_archivo_panel,'visible','off');            set(handles.subida_archivo_panel_nuevo,'visible','off');        else                        set(handles.subida_manual_panel,'visible','off');            set(handles.subida_grupo,'visible','on');            set(handles.sub_grupo_con,'value',0);            set(handles.subida_archivo_panel,'visible','off');            set(handles.sub_grupo_sin,'value',0);            set(handles.subida_archivo_panel_nuevo,'visible','off');        end    end%% ---------------------------------------------------------------------------    function sub_grupo_sin_Callback(hObject,evendata) %#ok<INUSD>        if get(handles.sub_grupo_con,'value')==1            set(handles.sub_grupo_con,'value',0);            set(handles.subida_archivo_panel,'visible','off');            set(handles.subida_archivo_panel_nuevo,'visible','on');        elseif get(handles.sub_grupo_sin,'value')==0            set(handles.subida_archivo_panel_nuevo,'visible','off');            set(handles.subida_archivo_panel,'visible','off');        else                    set(handles.subida_archivo_panel_nuevo,'visible','on');            set(handles.sub_grupo_con,'value',0);            set(handles.subida_archivo_panel,'visible','off');        end    end%% ---------------------------------------------------------------------------    function sub_grupo_con_Callback(hObject,evendata) %#ok<INUSD>        if get(handles.sub_grupo_sin,'value')==1            set(handles.sub_grupo_sin,'value',0);            set(handles.subida_archivo_panel,'visible','on');            set(handles.subida_archivo_panel_nuevo,'visible','off');        elseif get(handles.sub_grupo_con,'value')==0            set(handles.subida_archivo_panel_nuevo,'visible','off');            set(handles.subida_archivo_panel,'visible','off');        else                    set(handles.subida_archivo_panel_nuevo,'visible','off');            set(handles.sub_grupo_sin,'value',0);            set(handles.subida_archivo_panel,'visible','on');        end    endend